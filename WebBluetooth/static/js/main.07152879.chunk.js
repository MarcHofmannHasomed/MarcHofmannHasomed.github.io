(this.webpackJsonpsimplewebbluetoothviewer=this.webpackJsonpsimplewebbluetoothviewer||[]).push([[0],{165:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(56),i=a.n(c),s=(a(67),a(3)),o=a(4),l=a(13),u=a(10),v=a(9),h=(a(19),a(167)),m=a(168),d=a(169),p=(a(68),function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"topright"},r.a.createElement("img",{src:"SmartSystems-Icon.jpg",alt:"smart_systems_logo",width:"150",height:"150"})),r.a.createElement("div",{className:"bottomright"},r.a.createElement("img",{src:"haso_schnitt.jpg",alt:"haso_logo",width:"157",height:"168"})))}}]),a}(r.a.Component)),f=a(61),b=a(29),E=a(57),g=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){for(var e=this,t=0,n=0,c=Array.from(this.props.Values.values());n<c.length;n++){var i=c[n];t=Math.max(t,i.length)}t=Math.min(t,a.CHART_VALUE_COUNT);var s=Array.from(Array(t).keys()).map((function(e){return e.toString()})),o=[];Array.from(this.props.Values,(function(t){var a=Object(b.a)(t,2),n=a[0],r=a[1];o.push({data:e.getChartValues(r),label:n,lineTension:0,fill:!1})}));var l={labels:s,datasets:o};return r.a.createElement(E.a,{data:l,options:{elements:{line:{capBezierPoints:!1,tension:0}},animation:{duration:0}}})}},{key:"getChartValues",value:function(e){var t=Object(f.a)(e);return t.length>a.CHART_VALUE_COUNT&&t.splice(0,t.length-a.CHART_VALUE_COUNT),t}}]),a}(r.a.Component);g.CHART_VALUE_COUNT=120;var I=a(59),C=a(6),D=a.n(C),S=a(15),U=a(170),k=a(166),_=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,null,[{key:"getName",value:function(e){this.init();var t=this.mUuids.get(e);return void 0===t&&(t=e),t}},{key:"init",value:function(){this.mInit||(this.mInit=!0,this.mUuids.set(this.TIME_SERVER_SERVICE_UUID,"Time service"),this.mUuids.set(this.FINA_SERVICE_UUID,"Breathing service"),this.mUuids.set(this.FINA2_SERVICE_UUID,"STM32 BLE service"),this.mUuids.set(this.TIME_SERVER_CHARACTERISTIC_UUID,"Get time"),this.mUuids.set(this.FINA_CHARACTERISTIC_UUID,"Get values"),this.mUuids.set(this.FINA2_CHARACTERISTIC_UUID,"Get values"))}}]),e}();_.TIME_SERVER_SERVICE_UUID="00001805-0000-1000-8000-00805f9b34fb",_.TIME_SERVER_CHARACTERISTIC_UUID="00002a2b-0000-1000-8000-00805f9b34fb",_.FINA_SERVICE_UUID="00000000-0001-11e1-9ab4-0002a5d5c51b",_.FINA_CHARACTERISTIC_UUID="10000000-0001-11e1-ac36-0002a5d5c51b",_.FINA2_SERVICE_UUID="0000fe40-cc7a-482a-984a-7f2ed5b3e58f",_.FINA2_CHARACTERISTIC_UUID="0000aacc-8e22-4541-9d4c-21edae82ed19",_.mInit=!1,_.mUuids=new Map;var A=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e);var r=new Map;return n.props.Characteristics.forEach((function(e){return r.set(e.uuid,!1)})),n.state={Notifications:r},n.handleData=n.handleData.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=r.a.createElement("thead",null,r.a.createElement("tr",null,["#","UUID","Notification","Action",""].map((function(e,t){return r.a.createElement("th",{key:t},e)})))),a=this.props.Characteristics.map((function(t,a){return r.a.createElement("tbody",{key:a},r.a.createElement("tr",{className:"clickable-row"},r.a.createElement("td",null,a),r.a.createElement("td",null,_.getName(t.uuid)),r.a.createElement("td",null,t.properties.notify.toString()),r.a.createElement("td",null,r.a.createElement("a",{href:"#",onClick:function(a){a.preventDefault(),Object(S.a)(D.a.mark((function a(){var n;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!e.props.IncomingDataCb){a.next=6;break}return a.next=4,t.readValue();case 4:n=a.sent,e.props.IncomingDataCb(e.props.Service,t,n);case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.error(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()}},"Read")),r.a.createElement("td",null,r.a.createElement("a",{href:"#",onClick:function(a){a.preventDefault(),Object(S.a)(D.a.mark((function a(){var n,r;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t.properties.notify){a.next=3;break}return a.abrupt("return");case 3:if(n=e.state.Notifications,!(r=!n.get(t.uuid))){a.next=11;break}return t.addEventListener("characteristicvaluechanged",(function(a){e.handleData(a,t)})),a.next=9,t.startNotifications();case 9:a.next=14;break;case 11:return t.removeEventListener("characteristicvaluechanged",(function(a){e.handleData(a,t)})),a.next=14,t.stopNotifications();case 14:n.set(t.uuid,r),e.setState({Notifications:n}),a.next=21;break;case 18:a.prev=18,a.t0=a.catch(0),console.error(a.t0);case 21:case"end":return a.stop()}}),a,null,[[0,18]])})))()}},t.properties.notify?e.state.Notifications.get(t.uuid)?"Stop notification":"Start notification":""))))}));return r.a.createElement("div",null,"Service: ",_.getName(this.props.Service.uuid),r.a.createElement(k.a,{className:"table-hover"},t,a))}},{key:"handleData",value:function(e,t){if(e&&e.target){var a=e.target.value;this.props.IncomingDataCb&&this.props.IncomingDataCb(this.props.Service,t,a)}}}]),a}(r.a.Component),y=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={Device:void 0,Services:new Map},n.handleData=n.handleData.bind(Object(l.a)(n)),n.handleDisconnect=n.handleDisconnect.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(h.a,null,r.a.createElement(m.a,null),r.a.createElement(m.a,null,r.a.createElement(d.a,null,r.a.createElement(U.a,{type:"button",variant:"primary",disabled:void 0!==this.state.Device,onClick:function(){return e.discoverDevices()}},this.getButtonName())),r.a.createElement(d.a,null,"Device: ",this.state.Device?this.state.Device.name:"")),r.a.createElement(m.a,null,r.a.createElement(d.a,null)),Array.from(this.state.Services,(function(t){var a=Object(b.a)(t,2),n=a[0],c=a[1];return r.a.createElement(m.a,{key:n.uuid},r.a.createElement(d.a,null,r.a.createElement(A,{Service:n,Characteristics:c,IncomingDataCb:e.handleData})))})))}},{key:"getButtonName",value:function(){return this.state.Device?"Disconnect":"Connect"}},{key:"getBluetooth",value:function(){return window.navigator.bluetooth}},{key:"discoverDevices",value:function(){var e=this;Object(S.a)(D.a.mark((function t(){var a,n,r,c;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.getBluetooth(),t.next=4,a.getAvailability();case 4:if(n=t.sent,console.warn("BT LE available "+n),!n){t.next=15;break}return r={filters:[{name:"P2PSRV1"}],optionalServices:[_.FINA_SERVICE_UUID,_.FINA2_SERVICE_UUID]},t.next=10,a.requestDevice(r);case 10:if(c=t.sent,console.log(c),c&&c.gatt){t.next=14;break}return t.abrupt("return");case 14:e.setState({Device:c},(function(){e.connect()}));case 15:t.next=22;break;case 17:t.prev=17,t.t0=t.catch(0),console.error("error in discoverDevices"),console.error(t.t0),e.setState({Device:void 0,Services:new Map});case 22:case"end":return t.stop()}}),t,null,[[0,17]])})))()}},{key:"connect",value:function(){var e=this;Object(S.a)(D.a.mark((function t(){var a,n,r,c,i,s,o,l;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(a=e.state.Device)&&a.gatt){t.next=4;break}return t.abrupt("return");case 4:return n=new Map,a.addEventListener("gattserverdisconnected",e.handleDisconnect),t.next=8,a.gatt.connect();case 8:return r=t.sent,console.log(r),t.next=12,r.getPrimaryServices();case 12:c=t.sent,console.log(c),i=Object(I.a)(c),t.prev=15,i.s();case 17:if((s=i.n()).done){t.next=26;break}return o=s.value,t.next=21,o.getCharacteristics();case 21:l=t.sent,console.log(l),n.set(o,l);case 24:t.next=17;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(15),i.e(t.t0);case 31:return t.prev=31,i.f(),t.finish(31);case 34:e.setState({Services:n}),t.next=42;break;case 37:t.prev=37,t.t1=t.catch(0),console.error("error in connect"),console.error(t.t1),e.setState({Device:void 0,Services:new Map});case 42:case"end":return t.stop()}}),t,null,[[0,37],[15,28,31,34]])})))()}},{key:"disconnect",value:function(){var e=this;Object(S.a)(D.a.mark((function t(){var a;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(a=e.state.Device)&&a.gatt){t.next=4;break}return t.abrupt("return");case 4:a.gatt.connected&&(a.gatt.disconnect(),e.setState({Device:void 0,Services:new Map})),t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("error in disconnect"),console.error(t.t0),e.setState({Device:void 0,Services:new Map});case 12:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},{key:"handleDisconnect",value:function(e){console.log("disconnect"),this.disconnect()}},{key:"handleData",value:function(e,t,a){console.log(a);for(var n=[],r=0;r<a.byteLength;r++)n.push("0x00"+a.getUint8(r).toString(16).slice(-2));var c=n.join(" ");if(console.log(c),this.props.IncomingDataCb){var i=0;t.uuid===_.TIME_SERVER_CHARACTERISTIC_UUID?i=a.getUint8(6):t.uuid===_.FINA_CHARACTERISTIC_UUID&&(i=a.getInt16(2,!0)),this.props.IncomingDataCb(t.uuid,i)}}}]),a}(r.a.Component),R=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={Values:new Map},n.handleIncomingData=n.handleIncomingData.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"mt-5"},r.a.createElement(p,null),r.a.createElement(h.a,null,r.a.createElement(m.a,null,r.a.createElement(d.a,null,r.a.createElement("div",{className:"mt-5"},r.a.createElement(y,{IncomingDataCb:this.handleIncomingData})),r.a.createElement("div",{className:"mt-5"},r.a.createElement(g,{Values:this.state.Values}))))))}},{key:"handleIncomingData",value:function(e,t){var a=this.state.Values.get(e)?this.state.Values.get(e):[];a.push(t);var n=this.state.Values;n.set(e,a),this.setState({Values:n})}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},62:function(e,t,a){e.exports=a(165)},67:function(e,t,a){},68:function(e,t,a){}},[[62,1,2]]]);
//# sourceMappingURL=main.07152879.chunk.js.map
(this.webpackJsonpsimplewebbluetoothviewer=this.webpackJsonpsimplewebbluetoothviewer||[]).push([[0],{165:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(56),i=a.n(c),s=(a(67),a(5)),o=a(6),l=a(13),u=a(9),v=a(8),h=(a(19),a(168)),m=a(169),d=a(170),f=(a(68),a(166)),p=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"topright"},r.a.createElement(f.a,{src:"SmartSystems-Icon.jpg",width:"auto",height:"100%"})),r.a.createElement("div",{className:"bottomright wrapper"},r.a.createElement(f.a,{src:"haso_schnitt.jpg",width:"auto",height:"100%"})))}}]),a}(r.a.Component),E=a(61),b=a(29),I=a(58),g=function(){function e(){Object(s.a)(this,e)}return Object(o.a)(e,null,[{key:"getName",value:function(e){this.init();var t=this.mUuids.get(e);return void 0===t&&(t=e),t}},{key:"init",value:function(){this.mInit||(this.mInit=!0,this.mUuids.set(this.TIME_SERVER_SERVICE_UUID,"Time service"),this.mUuids.set(this.FINA_SERVICE_UUID,"Breathing service"),this.mUuids.set(this.FINA2_SERVICE_UUID,"STM32 BLE service"),this.mUuids.set(this.TIME_SERVER_CHARACTERISTIC_UUID,"Get time"),this.mUuids.set(this.FINA_CHARACTERISTIC_UUID,"Get values"),this.mUuids.set(this.FINA2_CHARACTERISTIC_UUID,"Get values"))}}]),e}();g.TIME_SERVER_SERVICE_UUID="00001805-0000-1000-8000-00805f9b34fb",g.TIME_SERVER_CHARACTERISTIC_UUID="00002a2b-0000-1000-8000-00805f9b34fb",g.FINA_SERVICE_UUID="00000000-0001-11e1-9ab4-0002a5d5c51b",g.FINA_CHARACTERISTIC_UUID="10000000-0001-11e1-ac36-0002a5d5c51b",g.FINA2_SERVICE_UUID="0000fe40-cc7a-482a-984a-7f2ed5b3e58f",g.FINA2_CHARACTERISTIC_UUID="0000aacc-8e22-4541-9d4c-21edae82ed19",g.mInit=!1,g.mUuids=new Map;var C=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){for(var e=this,t=0,n=0,c=Array.from(this.props.Values.values());n<c.length;n++){var i=c[n];t=Math.max(t,i.length)}t=Math.min(t,a.CHART_VALUE_COUNT);var s=Array.from(Array(t).keys()).map((function(e){return e.toString()})),o=[];Array.from(this.props.Values,(function(t){var a=Object(b.a)(t,2),n=a[0],r=a[1];o.push({data:e.getChartValues(r),label:g.getName(n),lineTension:0,fill:!1})}));var l={labels:s,datasets:o};return r.a.createElement(I.a,{data:l,options:{elements:{line:{capBezierPoints:!1,tension:0}},animation:{duration:0}}})}},{key:"getChartValues",value:function(e){var t=Object(E.a)(e);return t.length>a.CHART_VALUE_COUNT&&t.splice(0,t.length-a.CHART_VALUE_COUNT),t}}]),a}(r.a.Component);C.CHART_VALUE_COUNT=120;var D=a(60),S=a(10),U=a.n(S),k=a(17),_=a(171),A=a(167),y=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e);var r=new Map;return n.state={Notifications:r},n.handleData=n.handleData.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=r.a.createElement("thead",null,r.a.createElement("tr",null,["#","Service","Characteristic","Action"].map((function(e,t){return r.a.createElement("th",{key:t},e)})))),a=Array.from(this.props.Services,(function(t){var a=Object(b.a)(t,2),n=a[0];return a[1].map((function(t,a){return r.a.createElement("tbody",{key:a},r.a.createElement("tr",{className:"clickable-row"},r.a.createElement("td",null,a),r.a.createElement("td",null,g.getName(n.uuid)),r.a.createElement("td",null,g.getName(t.uuid)),r.a.createElement("td",null,r.a.createElement("a",{href:"#",onClick:function(a){a.preventDefault(),Object(k.a)(U.a.mark((function a(){var n,r;return U.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t.properties.notify){a.next=3;break}return a.abrupt("return");case 3:if(n=e.state.Notifications,!(r=!n.get(t.uuid))){a.next=11;break}return t.addEventListener("characteristicvaluechanged",(function(a){e.handleData(a,t)})),a.next=9,t.startNotifications();case 9:a.next=14;break;case 11:return t.removeEventListener("characteristicvaluechanged",(function(a){e.handleData(a,t)})),a.next=14,t.stopNotifications();case 14:n.set(t.uuid,r),e.setState({Notifications:n}),a.next=21;break;case 18:a.prev=18,a.t0=a.catch(0),console.error(a.t0);case 21:case"end":return a.stop()}}),a,null,[[0,18]])})))()}},t.properties.notify?e.state.Notifications.get(t.uuid)?"Stop notification":"Start notification":""))))}))}));return r.a.createElement("div",null,r.a.createElement(A.a,{className:"table-hover"},t,a))}},{key:"handleData",value:function(e,t){if(e&&e.target&&t&&t.service){var a=e.target.value;this.props.IncomingDataCb&&this.props.IncomingDataCb(t.service,t,a)}}}]),a}(r.a.Component),R=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={Device:void 0,Services:new Map},n.handleData=n.handleData.bind(Object(l.a)(n)),n.handleDisconnect=n.handleDisconnect.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(h.a,null,r.a.createElement(m.a,null),r.a.createElement(m.a,null,r.a.createElement(d.a,null,r.a.createElement(_.a,{type:"button",variant:"primary",onClick:function(){return e.handleButtonClick()}},this.getButtonName())),r.a.createElement(d.a,null,"Device: ",this.state.Device?this.state.Device.name:"")),r.a.createElement(m.a,null,r.a.createElement(d.a,null)),r.a.createElement(m.a,{className:"mt-5"},r.a.createElement(d.a,null,r.a.createElement(y,{Services:this.state.Services,IncomingDataCb:this.handleData}))))}},{key:"getButtonName",value:function(){return this.state.Device?"Disconnect":"Connect"}},{key:"handleButtonClick",value:function(){this.state.Device?this.disconnect():this.discoverDevices()}},{key:"getBluetooth",value:function(){return window.navigator.bluetooth}},{key:"discoverDevices",value:function(){var e=this;Object(k.a)(U.a.mark((function t(){var a,n,r,c;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.getBluetooth(),t.next=4,a.getAvailability();case 4:if(n=t.sent,console.warn("BT LE available "+n),!n){t.next=15;break}return r={filters:[{name:"P2PSRV1"}],optionalServices:[g.FINA_SERVICE_UUID,g.FINA2_SERVICE_UUID]},t.next=10,a.requestDevice(r);case 10:if(c=t.sent,console.log(c),c&&c.gatt){t.next=14;break}return t.abrupt("return");case 14:e.setState({Device:c},(function(){e.connect()}));case 15:t.next=22;break;case 17:t.prev=17,t.t0=t.catch(0),console.error("error in discoverDevices"),console.error(t.t0),e.setState({Device:void 0,Services:new Map});case 22:case"end":return t.stop()}}),t,null,[[0,17]])})))()}},{key:"connect",value:function(){var e=this;Object(k.a)(U.a.mark((function t(){var a,n,r,c,i,s,o,l;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(a=e.state.Device)&&a.gatt){t.next=4;break}return t.abrupt("return");case 4:return n=new Map,a.addEventListener("gattserverdisconnected",e.handleDisconnect),t.next=8,a.gatt.connect();case 8:return r=t.sent,console.log(r),t.next=12,r.getPrimaryServices();case 12:c=t.sent,console.log(c),i=Object(D.a)(c),t.prev=15,i.s();case 17:if((s=i.n()).done){t.next=26;break}return o=s.value,t.next=21,o.getCharacteristics();case 21:l=t.sent,console.log(l),n.set(o,l);case 24:t.next=17;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(15),i.e(t.t0);case 31:return t.prev=31,i.f(),t.finish(31);case 34:e.setState({Services:n}),t.next=42;break;case 37:t.prev=37,t.t1=t.catch(0),console.error("error in connect"),console.error(t.t1),e.setState({Device:void 0,Services:new Map});case 42:case"end":return t.stop()}}),t,null,[[0,37],[15,28,31,34]])})))()}},{key:"disconnect",value:function(){var e=this;Object(k.a)(U.a.mark((function t(){var a;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(a=e.state.Device)&&a.gatt){t.next=4;break}return t.abrupt("return");case 4:a.gatt.connected&&e.setState({Device:void 0,Services:new Map},(function(){a.gatt&&a.gatt.disconnect()})),t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("error in disconnect"),console.error(t.t0),e.setState({Device:void 0,Services:new Map});case 12:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},{key:"handleDisconnect",value:function(e){console.log("disconnect"),this.disconnect()}},{key:"handleData",value:function(e,t,a){console.log(a);for(var n=[],r=0;r<a.byteLength;r++)n.push("0x00"+a.getUint8(r).toString(16).slice(-2));var c=n.join(" ");if(console.log(c),this.props.IncomingDataCb){var i=0;t.uuid===g.TIME_SERVER_CHARACTERISTIC_UUID?i=a.getUint8(6):t.uuid===g.FINA_CHARACTERISTIC_UUID&&(i=a.getInt16(2,!0)),this.props.IncomingDataCb(t.uuid,i)}}}]),a}(r.a.Component),O=function(e){Object(u.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={Values:new Map},n.handleIncomingData=n.handleIncomingData.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"mt-5"},r.a.createElement(p,null),r.a.createElement(h.a,null,r.a.createElement(m.a,{className:"mt-5"},r.a.createElement(d.a,null,r.a.createElement(R,{IncomingDataCb:this.handleIncomingData}))),r.a.createElement(m.a,{className:"mt-5"},r.a.createElement(d.a,null,r.a.createElement(C,{Values:this.state.Values}))),r.a.createElement(m.a,{className:"mt-5"},r.a.createElement(d.a,null))))}},{key:"handleIncomingData",value:function(e,t){var a=this.state.Values.get(e)?this.state.Values.get(e):[];a.push(t);var n=this.state.Values;n.set(e,a),this.setState({Values:n})}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},62:function(e,t,a){e.exports=a(165)},67:function(e,t,a){},68:function(e,t,a){}},[[62,1,2]]]);
//# sourceMappingURL=main.b42b8568.chunk.js.map
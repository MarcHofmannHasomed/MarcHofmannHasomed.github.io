(this.webpackJsonptest1=this.webpackJsonptest1||[]).push([[0],{164:function(e,t,a){},165:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(55),i=a.n(c),s=(a(67),a(60)),o=a(56),l=a(4),u=a.n(l),v=a(11),p=a(37),d=a(24),f=a(25),h=a(10),b=a(27),m=a(26),E=(a(39),a(167)),g=a(168),C=a(169),D=a(170),k=a(57),I=(a(164),a(166)),S=function(e){Object(b.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(d.a)(this,a),n=t.call(this,e);var r=new Map;return n.props.Characteristics.forEach((function(e){return r.set(e.uuid,!1)})),n.state={Notifications:r},n.handleData=n.handleData.bind(Object(h.a)(n)),n}return Object(f.a)(a,[{key:"render",value:function(){var e=this,t=r.a.createElement("thead",null,r.a.createElement("tr",null,["#","UUID","Properties","",""].map((function(e,t){return r.a.createElement("th",{key:t},e)})))),a=this.props.Characteristics.map((function(t,a){return r.a.createElement("tbody",{key:a},r.a.createElement("tr",{className:"clickable-row"},r.a.createElement("td",null,a),r.a.createElement("td",null,t.uuid),r.a.createElement("td",null,t.properties.notify.toString()),r.a.createElement("td",null,r.a.createElement("a",{href:"#",onClick:function(a){a.preventDefault(),Object(v.a)(u.a.mark((function a(){var n;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!e.props.IncomingDataCb){a.next=6;break}return a.next=4,t.readValue();case 4:n=a.sent,e.props.IncomingDataCb(e.props.Service,t,n);case 6:a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.error(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()}},"Read")),r.a.createElement("td",null,r.a.createElement("a",{href:"#",onClick:function(a){a.preventDefault(),Object(v.a)(u.a.mark((function a(){var n,r;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t.properties.notify){a.next=3;break}return a.abrupt("return");case 3:if(n=e.state.Notifications,!(r=!n.get(t.uuid))){a.next=11;break}return t.addEventListener("characteristicvaluechanged",(function(a){e.handleData(a,t)})),a.next=9,t.startNotifications();case 9:a.next=14;break;case 11:return t.removeEventListener("characteristicvaluechanged",(function(a){e.handleData(a,t)})),a.next=14,t.stopNotifications();case 14:n.set(t.uuid,r),e.setState({Notifications:n}),a.next=21;break;case 18:a.prev=18,a.t0=a.catch(0),console.error(a.t0);case 21:case"end":return a.stop()}}),a,null,[[0,18]])})))()}},t.properties.notify?e.state.Notifications.get(t.uuid)?"Stop notification":"Start notification":""))))}));return r.a.createElement("div",null,"Service: ",this.props.Service.uuid,r.a.createElement(I.a,{className:"table-hover"},t,a))}},{key:"handleData",value:function(e,t){if(e&&e.target){var a=e.target.value;this.props.IncomingDataCb&&this.props.IncomingDataCb(this.props.Service,t,a)}}}]),a}(r.a.Component),y=function(e){Object(b.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={Device:void 0,Services:new Map,Values:new Map},n.handleData=n.handleData.bind(Object(h.a)(n)),n.handleDisconnect=n.handleDisconnect.bind(Object(h.a)(n)),n}return Object(f.a)(a,[{key:"render",value:function(){for(var e=this,t=0,n=0,c=Array.from(this.state.Values.values());n<c.length;n++){var i=c[n];t=Math.max(t,i.length)}t=Math.min(t,a.CHART_VALUE_COUNT);var s=Array.from(Array(t).keys()).map((function(e){return e.toString()})),o=[];Array.from(this.state.Values,(function(t){var a=Object(p.a)(t,2),n=a[0],r=a[1];o.push({data:e.getChartValues(r),label:n,lineTension:0,fill:!1})}));var l={labels:s,datasets:o};return r.a.createElement("div",null,r.a.createElement(E.a,null,r.a.createElement(g.a,null),r.a.createElement(g.a,null,r.a.createElement(C.a,null,r.a.createElement(D.a,{type:"button",variant:"primary",disabled:void 0!==this.state.Device,onClick:function(){return e.discoverDevices()}},"Discover")),r.a.createElement(C.a,null,r.a.createElement(D.a,{type:"button",variant:"primary",disabled:void 0===this.state.Device||this.state.Services.size>0,onClick:function(){return e.connect()}},"Connect")),r.a.createElement(C.a,null,r.a.createElement(D.a,{type:"button",variant:"primary",disabled:void 0===this.state.Device||0===this.state.Services.size,onClick:function(){return e.disconnect()}},"Disconnect"))),r.a.createElement(g.a,null,r.a.createElement(C.a,null,"Device: ",this.state.Device?this.state.Device.name:"")),Array.from(this.state.Services,(function(t){var a=Object(p.a)(t,2),n=a[0],c=a[1];return r.a.createElement(g.a,{key:n.uuid},r.a.createElement(S,{Service:n,Characteristics:c,IncomingDataCb:e.handleData}))})),r.a.createElement(k.a,{data:l,options:{elements:{line:{capBezierPoints:!1,tension:0}},animation:{duration:0}}})))}},{key:"getBluetooth",value:function(){return window.navigator.bluetooth}},{key:"discoverDevices",value:function(){var e=this;Object(v.a)(u.a.mark((function t(){var n,r,c,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.getBluetooth(),t.next=4,n.getAvailability();case 4:if(r=t.sent,console.warn("BT LE available "+r),!r){t.next=15;break}return c={filters:[{name:"P2PSRV1"}],optionalServices:[a.FINA_SERVICE_UUID,a.FINA2_SERVICE_UUID]},t.next=10,n.requestDevice(c);case 10:if(i=t.sent,console.log(i),i&&i.gatt){t.next=14;break}return t.abrupt("return");case 14:e.setState({Device:i});case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.error(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])})))()}},{key:"connect",value:function(){var e=this;Object(v.a)(u.a.mark((function t(){var a,n,r,c,i,s,l,v;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(a=e.state.Device)&&a.gatt){t.next=4;break}return t.abrupt("return");case 4:return n=new Map,a.addEventListener("gattserverdisconnected",e.handleDisconnect),t.next=8,a.gatt.connect();case 8:return r=t.sent,console.log(r),t.next=12,r.getPrimaryServices();case 12:c=t.sent,console.log(c),i=Object(o.a)(c),t.prev=15,i.s();case 17:if((s=i.n()).done){t.next=26;break}return l=s.value,t.next=21,l.getCharacteristics();case 21:v=t.sent,console.log(v),n.set(l,v);case 24:t.next=17;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(15),i.e(t.t0);case 31:return t.prev=31,i.f(),t.finish(31);case 34:e.setState({Services:n,Values:new Map}),t.next=40;break;case 37:t.prev=37,t.t1=t.catch(0),console.error(t.t1);case 40:case"end":return t.stop()}}),t,null,[[0,37],[15,28,31,34]])})))()}},{key:"disconnect",value:function(){var e=this;Object(v.a)(u.a.mark((function t(){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(a=e.state.Device)&&a.gatt){t.next=4;break}return t.abrupt("return");case 4:a.gatt.connected&&(a.gatt.disconnect(),e.setState({Device:void 0,Services:new Map})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},{key:"handleDisconnect",value:function(e){console.log("disconnect"),this.disconnect()}},{key:"handleData",value:function(e,t,n){console.log(n);for(var r=[],c=0;c<n.byteLength;c++)r.push("0x00"+n.getUint8(c).toString(16).slice(-2));var i=r.join(" ");console.log(i);var s=this.state.Values.get(t.uuid)?this.state.Values.get(t.uuid):[];t.uuid===a.TIME_SERVER_CHARACTERISTIC_UUID?s.push(n.getUint8(6)):t.uuid===a.FINA_CHARACTERISTIC_UUID&&s.push(n.getInt16(2,!0));var o=this.state.Values;o.set(t.uuid,s),this.setState({Values:o})}},{key:"getChartValues",value:function(e){var t=Object(s.a)(e);return t.length>a.CHART_VALUE_COUNT&&t.splice(0,t.length-a.CHART_VALUE_COUNT),t}}]),a}(r.a.Component);y.TIME_SERVER_SERVICE_UUID="00001805-0000-1000-8000-00805f9b34fb",y.TIME_SERVER_CHARACTERISTIC_UUID="00002a2b-0000-1000-8000-00805f9b34fb",y.FINA_SERVICE_UUID="00000000-0001-11e1-9ab4-0002a5d5c51b",y.FINA_CHARACTERISTIC_UUID="10000000-0001-11e1-ac36-0002a5d5c51b",y.FINA2_SERVICE_UUID="0000fe40-cc7a-482a-984a-7f2ed5b3e58f",y.FINA2_CHARACTERISTIC_UUID="0000aacc-8e22-4541-9d4c-21edae82ed19",y.CHART_VALUE_COUNT=120;var x=y;i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(x,null)),document.getElementById("root"))},62:function(e,t,a){e.exports=a(165)},67:function(e,t,a){}},[[62,1,2]]]);
//# sourceMappingURL=main.e9802279.chunk.js.map